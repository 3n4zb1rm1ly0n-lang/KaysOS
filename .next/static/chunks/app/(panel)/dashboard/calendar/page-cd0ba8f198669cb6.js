(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[463],{94288:function(e,t,a){Promise.resolve().then(a.bind(a,67888))},67888:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var n=a(57437),r=a(2265),i=a(56739),l=a(26062),s=a(50838),d=a(646),c=a(2575),o=a(55036);function u(e,t,a){let n=(0,o.Q)(e,null==a?void 0:a.in);return n.setDate(t),n}var m=a(38549),y=a(23689),g=a(8971),f=a(6496),x=a(29955),h=a(14993);let p={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},b=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,v=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,N=/^([+-])(\d{2})(?::?(\d{2}))?$/;function D(e){return e?parseInt(e):1}function w(e){return e&&parseFloat(e.replace(",","."))||0}let M=[31,null,31,30,31,30,31,31,30,31,30,31];function j(e){return e%400==0||e%4==0&&e%100!=0}var U=a(6364);function T(e,t){return(0,o.Q)(e,null==t?void 0:t.in).getDay()}var k=a(56290),Y=a(92451),W=a(10407),F=a(5526),C=a(81838);let I=e=>{let{type:t,title:a,amount:r}=e;return(0,n.jsxs)("div",{className:"text-[10px] px-1.5 py-0.5 rounded border mb-1 truncate ".concat((()=>{switch(t){case"incomes":return"bg-green-500/10 text-green-500 border-green-500/20";case"invoices":return"bg-orange-500/10 text-orange-500 border-orange-500/20";case"debts":return"bg-red-500/10 text-red-500 border-red-500/20";case"expenses":return"bg-blue-500/10 text-blue-500 border-blue-500/20";case"tax":return"bg-purple-500/10 text-purple-500 border-purple-500/20";default:return"bg-gray-500/10 text-gray-500"}})()),title:"".concat(a," - ").concat(r),children:[(0,n.jsx)("span",{className:"font-semibold",children:r})," - ",a]})};function _(){let[e,t]=(0,r.useState)(new Date),[a,_]=(0,r.useState)([]),[z,O]=(0,r.useState)(!0),S=(0,i.N)(e),V=(0,l.V)(e);(0,r.useEffect)(()=>{Z()},[e]);let Z=async()=>{O(!0);try{var t,a,n,r,o,y,g,f;let x=(0,s.WU)((0,d.z)(S),"yyyy-MM-dd"),h=(0,s.WU)((0,c.v)(V),"yyyy-MM-dd"),[p,b,v,N]=await Promise.all([F.O.from("incomes").select("*").gte("date",x).lte("date",h),F.O.from("expenses").select("*").gte("date",x).lte("date",h),F.O.from("debts").select("*"),F.O.from("recurring_expenses").select("*")]),D=[];null===(t=p.data)||void 0===t||t.forEach(e=>{D.push({id:"inc-".concat(e.id),date:e.date,title:e.source,amount:"₺".concat(e.amount),type:"incomes"})}),null===(a=b.data)||void 0===a||a.forEach(e=>{D.push({id:"exp-".concat(e.id),date:e.date,title:e.recipient,amount:"₺".concat(e.amount),type:"expenses"})}),null===(n=v.data)||void 0===n||n.forEach(e=>{e.due_date&&D.push({id:"debt-".concat(e.id),date:e.due_date,title:"Bor\xe7 \xd6demesi: ".concat(e.creditor),amount:"₺".concat(e.amount),type:"debts"})}),null===(r=N.data)||void 0===r||r.forEach(t=>{try{let a=u(e,t.day_of_month);t.day_of_month,D.push({id:"inv-".concat(t.id,"-").concat((0,s.WU)(e,"MM")),date:(0,s.WU)(a,"yyyy-MM-dd"),title:"".concat(t.name," (").concat(t.provider,")"),amount:"₺".concat(t.amount),type:"invoices"})}catch(e){console.error("Date calculation error",e)}});let w=u(e,28),M=(0,s.WU)((0,i.N)((0,m.W)(e,1)),"yyyy-MM-dd"),j=(0,s.WU)((0,l.V)((0,m.W)(e,1)),"yyyy-MM-dd"),[U,T]=await Promise.all([F.O.from("incomes").select("tax_amount").gte("date",M).lte("date",j),F.O.from("expenses").select("tax_amount").gte("date",M).lte("date",j)]),k=(null===(o=U.data)||void 0===o?void 0:o.reduce((e,t)=>e+(t.tax_amount||0),0))||0,Y=(null===(y=T.data)||void 0===y?void 0:y.reduce((e,t)=>e+(t.tax_amount||0),0))||0,W=k-Y;W>0&&D.push({id:"kdv-".concat((0,s.WU)(e,"yyyy-MM")),date:(0,s.WU)(w,"yyyy-MM-dd"),title:"KDV \xd6demesi",amount:"₺".concat(W.toLocaleString("tr-TR",{maximumFractionDigits:2})),type:"tax"});let I=e.getMonth();if([1,4,7,10].includes(I)){e.getFullYear(),e.getFullYear();let t="",a="";if(4===I?(t=(0,s.WU)(new Date(e.getFullYear(),0,1),"yyyy-MM-dd"),a=(0,s.WU)(new Date(e.getFullYear(),2,31),"yyyy-MM-dd")):7===I?(t=(0,s.WU)(new Date(e.getFullYear(),3,1),"yyyy-MM-dd"),a=(0,s.WU)(new Date(e.getFullYear(),5,30),"yyyy-MM-dd")):10===I?(t=(0,s.WU)(new Date(e.getFullYear(),6,1),"yyyy-MM-dd"),a=(0,s.WU)(new Date(e.getFullYear(),8,30),"yyyy-MM-dd")):1===I&&(t=(0,s.WU)(new Date(e.getFullYear()-1,9,1),"yyyy-MM-dd"),a=(0,s.WU)(new Date(e.getFullYear()-1,11,31),"yyyy-MM-dd")),t){let[n,r]=await Promise.all([F.O.from("incomes").select("amount, tax_amount").gte("date",t).lte("date",a),F.O.from("expenses").select("amount, tax_amount").gte("date",t).lte("date",a)]),i=(null===(g=n.data)||void 0===g?void 0:g.reduce((e,t)=>e+(t.amount-(t.tax_amount||0)),0))||0,l=(null===(f=r.data)||void 0===f?void 0:f.reduce((e,t)=>e+(t.amount-(t.tax_amount||0)),0))||0;if(i-l>0){let t=(0,C.Eu)(i,l);D.push({id:"prov-".concat((0,s.WU)(e,"yyyy-MM")),date:(0,s.WU)(u(e,17),"yyyy-MM-dd"),title:"Ge\xe7ici Vergi (Tahmini)",amount:"~₺".concat(t.tax.toLocaleString("tr-TR",{maximumFractionDigits:0})),type:"tax"})}}}_(D)}catch(e){console.error("Error fetching calendar events",e)}finally{O(!1)}},E=(0,d.z)(S,{weekStartsOn:1}),J=(0,c.v)(V,{weekStartsOn:1}),G=(0,y.D)({start:E,end:J});return(0,n.jsxs)("div",{className:"h-full flex flex-col space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Finansal Takvim"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"T\xfcm \xf6demelerinizi ve tahsilatlarınızı g\xfcn g\xfcn g\xf6r\xfcn."})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>t(new Date),className:"px-3 py-1.5 text-sm font-medium bg-secondary rounded-md hover:bg-secondary/80 transition-colors",children:"Bug\xfcn"}),(0,n.jsxs)("div",{className:"flex items-center bg-secondary rounded-md",children:[(0,n.jsx)("button",{onClick:()=>t((0,m.W)(e,1)),className:"p-1.5 hover:bg-white/10 rounded-l-md",children:(0,n.jsx)(Y.Z,{className:"w-5 h-5"})}),(0,n.jsx)("span",{className:"px-4 font-medium min-w-[140px] text-center capitalize",children:(0,s.WU)(e,"MMMM yyyy",{locale:k.tr})}),(0,n.jsx)("button",{onClick:()=>t((0,g.z)(e,1)),className:"p-1.5 hover:bg-white/10 rounded-r-md",children:(0,n.jsx)(W.Z,{className:"w-5 h-5"})})]})]})]}),(0,n.jsxs)("div",{className:"flex gap-4 text-sm flex-wrap",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"w-3 h-3 rounded-full bg-green-500"})," Gelirler"]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"w-3 h-3 rounded-full bg-orange-500"})," Faturalar"]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"w-3 h-3 rounded-full bg-red-500"})," Bor\xe7lar"]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"w-3 h-3 rounded-full bg-blue-500"})," Giderler"]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"w-3 h-3 rounded-full bg-purple-500"})," Vergiler"]})]}),(0,n.jsxs)("div",{className:"flex-1 bg-card border rounded-lg shadow-sm overflow-hidden flex flex-col",children:[(0,n.jsx)("div",{className:"grid grid-cols-7 border-b bg-secondary/30",children:["Pazartesi","Salı","\xc7arşamba","Perşembe","Cuma","Cumartesi","Pazar"].map(e=>(0,n.jsx)("div",{className:"py-2 text-center text-sm font-semibold text-muted-foreground",children:e},e))}),(0,n.jsx)("div",{className:"grid grid-cols-7 flex-1 auto-rows-fr",children:G.map((t,r)=>{let i=a.filter(e=>(0,f.K)(function(e,t){var a;let n,r;let i=()=>(0,h.L)(void 0,NaN),l=(a=void 0,2),s=function(e){let t;let a={},n=e.split(p.dateTimeDelimiter);if(n.length>2)return a;if(/:/.test(n[0])?t=n[0]:(a.date=n[0],t=n[1],p.timeZoneDelimiter.test(a.date)&&(a.date=e.split(p.timeZoneDelimiter)[0],t=e.substr(a.date.length,e.length))),t){let e=p.timezone.exec(t);e?(a.time=t.replace(e[1],""),a.timezone=e[1]):a.time=t}return a}(e);if(s.date){let e=function(e,t){let a=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(a);if(!n)return{year:NaN,restDateString:""};let r=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:null===i?r:100*i,restDateString:e.slice((n[1]||n[2]).length)}}(s.date,l);n=function(e,t){if(null===t)return new Date(NaN);let a=e.match(b);if(!a)return new Date(NaN);let n=!!a[4],r=D(a[1]),i=D(a[2])-1,l=D(a[3]),s=D(a[4]),d=D(a[5])-1;if(n)return s>=1&&s<=53&&d>=0&&d<=6?function(e,t,a){let n=new Date(0);n.setUTCFullYear(e,0,4);let r=n.getUTCDay()||7;return n.setUTCDate(n.getUTCDate()+((t-1)*7+a+1-r)),n}(t,s,d):new Date(NaN);{let e=new Date(0);return i>=0&&i<=11&&l>=1&&l<=(M[i]||(j(t)?29:28))&&r>=1&&r<=(j(t)?366:365)?(e.setUTCFullYear(t,i,Math.max(r,l)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!n||isNaN(+n))return i();let d=+n,c=0;if(s.time&&isNaN(c=function(e){let t=e.match(v);if(!t)return NaN;let a=w(t[1]),n=w(t[2]),r=w(t[3]);return(24===a?0===n&&0===r:r>=0&&r<60&&n>=0&&n<60&&a>=0&&a<25)?a*x.vh+n*x.yJ+1e3*r:NaN}(s.time)))return i();if(s.timezone){if(isNaN(r=function(e){if("Z"===e)return 0;let t=e.match(N);if(!t)return 0;let a="+"===t[1]?-1:1,n=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return r>=0&&r<=59?a*(n*x.vh+r*x.yJ):NaN}(s.timezone)))return i()}else{let e=new Date(d+c),t=(0,o.Q)(0,void 0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return(0,o.Q)(d+c+r,null==t?void 0:t.in)}(e.date),t)),l=(0,U.x)(t,e),d=(0,f.K)(t,new Date),c=0===T(t)||6===T(t);return(0,n.jsxs)("div",{className:"\n                  min-h-[120px] p-2 border-b border-r last:border-r-0 relative group transition-colors\n                  ".concat(l?c?"bg-white/5":"bg-background":"bg-black/40 text-muted-foreground/30","\n                  ").concat(d?"ring-2 ring-red-500 bg-blue-500/10 z-10":"","\n                  hover:bg-secondary/20\n                "),children:[(0,n.jsx)("div",{className:"flex justify-between items-start mb-1",children:(0,n.jsx)("span",{className:"\n                      text-sm font-medium w-7 h-7 flex items-center justify-center rounded-full\n                      ".concat(d?"bg-primary text-primary-foreground":"","\n                    "),children:(0,s.WU)(t,"d")})}),(0,n.jsx)("div",{className:"space-y-1 overflow-y-auto max-h-[90px] scrollbar-hide",children:i.map(e=>(0,n.jsx)(I,{type:e.type,title:e.title,amount:e.amount},e.id))})]},t.toString())})})]})]})}},5526:function(e,t,a){"use strict";a.d(t,{O:function(){return n}});let n=(0,a(13053).eI)("https://veyokbxkhyqaejautyva.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZleW9rYnhraHlxYWVqYXV0eXZhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAxMTY2ODksImV4cCI6MjA4NTY5MjY4OX0.69XhSOD4tQnpZASl2rCngcVLfO_b68tQTI6K16S9dGY")},81838:function(e,t,a){"use strict";a.d(t,{Eu:function(){return r},dB:function(){return n}});let n=()=>{let e=new Date,t=e.getFullYear(),a=e.getMonth(),n=[],r=a,i=t;e.getDate()>28&&(r=a+1)>11&&(r=0,i++);let l=new Date(i,r,28);n.push({title:"".concat(new Intl.DateTimeFormat("tr-TR",{month:"long"}).format(l)," KDV Beyanı"),date:l,type:"KDV",description:"Aylık KDV beyannamesi ve \xf6demesi",remainingDays:Math.ceil((l.getTime()-e.getTime())/864e5)});let s=[new Date(t,4,17),new Date(t,7,17),new Date(t,10,17),new Date(t+1,1,17)],d=s.find(t=>t>e)||s[0];d<e&&d.setFullYear(t+1),n.push({title:"Ge\xe7ici Vergi D\xf6nemi",date:d,type:"Ge\xe7ici",description:"3 aylık kazan\xe7 \xfczerinden peşin vergi",remainingDays:Math.ceil((d.getTime()-e.getTime())/864e5)});let c=new Date(t,2,31);return e>c&&c.setFullYear(t+1),n.push({title:"Yıllık Gelir Vergisi (1. Taksit)",date:c,type:"Yıllık",description:"Yıllık kazan\xe7 vergisi beyanı ve ilk taksit",remainingDays:Math.ceil((c.getTime()-e.getTime())/864e5)}),n.sort((e,t)=>e.remainingDays-t.remainingDays)},r=(e,t)=>{let a=e-t;if(a<=0)return{tax:0,effectiveRate:0,bracket:0};let n=a,r=0,i=0,l=0;for(let e of[{limit:158e3,rate:.15},{limit:33e4,rate:.2},{limit:8e5,rate:.27},{limit:3e6,rate:.35},{limit:1/0,rate:.4}]){let t=Math.min(n,e.limit-i);if(t<=0||(r+=t*e.rate,n-=t,i=e.limit,l=e.rate,n<=0))break}return{tax:r,effectiveRate:r/a*100,bracket:100*l}}}},function(e){e.O(0,[537,962,971,117,744],function(){return e(e.s=94288)}),_N_E=e.O()}]);